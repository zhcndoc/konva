"use strict";(self.webpackChunkkonva_site_2=self.webpackChunkkonva_site_2||[]).push([[7958],{8247:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>a,contentTitle:()=>i,default:()=>u,frontMatter:()=>c,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"docs/react/Undo-Redo","title":"\u5982\u4f55\u5728 React \u4e2d\u5b9e\u73b0\u753b\u5e03\u7684\u64a4\u9500/\u91cd\u505a\u529f\u80fd\uff1f","description":"\u8981\u5728 React \u4e2d\u5b9e\u73b0\u64a4\u9500/\u91cd\u505a\u529f\u80fd\uff0c\u60a8\u4e0d\u9700\u8981\u4f7f\u7528 Konva \u7684\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u65b9\u6cd5\u3002","source":"@site/content/docs/react/Undo-Redo.mdx","sourceDirName":"docs/react","slug":"/docs/react/Undo-Redo.html","permalink":"/docs/react/Undo-Redo.html","draft":false,"unlisted":false,"editUrl":"https://github.com/zhcndoc/konva/tree/main/content/docs/react/Undo-Redo.mdx","tags":[],"version":"current","frontMatter":{"title":"\u5982\u4f55\u5728 React \u4e2d\u5b9e\u73b0\u753b\u5e03\u7684\u64a4\u9500/\u91cd\u505a\u529f\u80fd\uff1f","sidebar_label":"\u64a4\u9500/\u91cd\u505a","hide_table_of_contents":true,"slug":"Undo-Redo.html"},"sidebar":"tutorialsSidebar","previous":{"title":"\u8f6c\u6362\u5668","permalink":"/docs/react/Transformer.html"},"next":{"title":"zIndex","permalink":"/docs/react/zIndex.html"}}');var r=e(74848),s=e(28453);const c={title:"\u5982\u4f55\u5728 React \u4e2d\u5b9e\u73b0\u753b\u5e03\u7684\u64a4\u9500/\u91cd\u505a\u529f\u80fd\uff1f",sidebar_label:"\u64a4\u9500/\u91cd\u505a",hide_table_of_contents:!0,slug:"Undo-Redo.html"},i=void 0,a={},d=[];function l(n){const t={code:"code",p:"p",pre:"pre",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:"\u8981\u5728 React \u4e2d\u5b9e\u73b0\u64a4\u9500/\u91cd\u505a\u529f\u80fd\uff0c\u60a8\u4e0d\u9700\u8981\u4f7f\u7528 Konva \u7684\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u65b9\u6cd5\u3002"}),"\n",(0,r.jsx)(t.p,{children:"\u60a8\u53ea\u9700\u8981\u4fdd\u5b58\u5e94\u7528\u7a0b\u5e8f\u4e2d\u6240\u6709\u72b6\u6001\u66f4\u6539\u7684\u5386\u53f2\u8bb0\u5f55\u3002\u6709\u5f88\u591a\u65b9\u6cd5\u53ef\u4ee5\u505a\u5230\u8fd9\u4e00\u70b9\u3002\u5982\u679c\u4f7f\u7528\u4e0d\u53ef\u53d8\u7ed3\u6784\uff0c\u53ef\u80fd\u4f1a\u66f4\u7b80\u5355\u3002"}),"\n",(0,r.jsx)(t.p,{children:"\u8bf4\u660e\uff1a\u5c1d\u8bd5\u901a\u8fc7\u62d6\u52a8\u79fb\u52a8\u6b63\u65b9\u5f62\u3002\u7136\u540e\u4f7f\u7528\u201c\u64a4\u9500\u201d\u548c\u201c\u91cd\u505a\u201d\u6309\u94ae\u6765\u64a4\u9500\u6216\u91cd\u653e\u60a8\u7684\u64cd\u4f5c\u3002"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",metastring:"live react",live:!0,children:'import React, { Component } from \'react\';\nimport { Stage, Layer, Rect, Text } from \'react-konva\';\n\n\nconst App = () => {\n  const [position, setPosition] = React.useState({ x: 20, y: 20 });\n  // \u6211\u4eec\u4f7f\u7528 refs \u6765\u4fdd\u6301\u5386\u53f2\u8bb0\u5f55\uff0c\u4ee5\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u91cd\u65b0\u6e32\u67d3\n  const history = React.useRef([{ x: 20, y: 20 }]);\n  const historyStep = React.useRef(0);\n\n  const handleUndo = () => {\n    if (historyStep.current === 0) {\n      return;\n    }\n    historyStep.current -= 1;\n    const previous = history.current[historyStep.current];\n    setPosition(previous);\n  };\n\n  const handleRedo = () => {\n    if (historyStep.current === history.current.length - 1) {\n      return;\n    }\n    historyStep.current += 1;\n    const next = history.current[historyStep.current];\n    setPosition(next);\n  };\n\n  const handleDragEnd = (e) => {\n    // \u5728\u5f53\u524d\u6b65\u9aa4\u4e4b\u540e\u79fb\u9664\u6240\u6709\u72b6\u6001\n    history.current = history.current.slice(0, historyStep.current + 1);\n    const pos = {\n      x: e.target.x(),\n      y: e.target.y(),\n    };\n    // \u6dfb\u52a0\u65b0\u72b6\u6001\n    history.current = history.current.concat([pos]);\n    historyStep.current += 1;\n    setPosition(pos);\n  };\n\n  return (\n    <Stage width={window.innerWidth} height={window.innerHeight}>\n      <Layer>\n        <Text text="\u64a4\u9500" onClick={handleUndo} />\n        <Text text="\u91cd\u505a" x={40} onClick={handleRedo} />\n        <Rect\n          x={position.x}\n          y={position.y}\n          width={50}\n          height={50}\n          fill="black"\n          draggable\n          onDragEnd={handleDragEnd}\n        />\n      </Layer>\n    </Stage>\n  );\n};\n\nexport default App;\n'})})]})}function u(n={}){const{wrapper:t}={...(0,s.R)(),...n.components};return t?(0,r.jsx)(t,{...n,children:(0,r.jsx)(l,{...n})}):l(n)}},28453:(n,t,e)=>{e.d(t,{R:()=>c,x:()=>i});var o=e(96540);const r={},s=o.createContext(r);function c(n){const t=o.useContext(s);return o.useMemo((function(){return"function"==typeof n?n(t):{...t,...n}}),[t,n])}function i(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:c(n.components),o.createElement(s.Provider,{value:t},n.children)}}}]);