"use strict";(self.webpackChunkkonva_site_2=self.webpackChunkkonva_site_2||[]).push([[9778],{39223:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>d,contentTitle:()=>u,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"docs/sandbox/Shape_Tango","title":"\u4f7f\u7528 Konva \u5728 HTML5 Canvas \u4e0a\u8df3\u5f62\u72b6\u63a2\u6208","description":"\u4f7f\u7528 Konva \u5728 HTML5 Canvas \u4e0a\u8df3\u5f62\u72b6\u63a2\u6208","source":"@site/content/docs/sandbox/Shape_Tango.mdx","sourceDirName":"docs/sandbox","slug":"/docs/sandbox/Shape_Tango.html","permalink":"/docs/sandbox/Shape_Tango.html","draft":false,"unlisted":false,"editUrl":"https://github.com/zhcndoc/konva/tree/main/content/docs/sandbox/Shape_Tango.mdx","tags":[],"version":"current","frontMatter":{"title":"\u4f7f\u7528 Konva \u5728 HTML5 Canvas \u4e0a\u8df3\u5f62\u72b6\u63a2\u6208","sidebar_label":"\u5f62\u72b6\u63a2\u6208","hide_table_of_contents":true,"slug":"Shape_Tango.html"},"sidebar":"tutorialsSidebar","previous":{"title":"\u5ea7\u4f4d\u9884\u8ba2","permalink":"/docs/sandbox/Seats_Reservation.html"},"next":{"title":"\u5f62\u72b6\u5de5\u5177\u63d0\u793a","permalink":"/docs/sandbox/Shape_Tooltips.html"}}');var o=a(74848),r=a(28453),s=a(11470),l=a(19365);const i={title:"\u4f7f\u7528 Konva \u5728 HTML5 Canvas \u4e0a\u8df3\u5f62\u72b6\u63a2\u6208",sidebar_label:"\u5f62\u72b6\u63a2\u6208",hide_table_of_contents:!0,slug:"Shape_Tango.html"},u=void 0,d={},c=[{value:"\u4f7f\u7528 Konva \u5728 HTML5 Canvas \u4e0a\u8df3\u5f62\u72b6\u63a2\u6208",id:"\u4f7f\u7528-konva-\u5728-html5-canvas-\u4e0a\u8df3\u5f62\u72b6\u63a2\u6208",level:2}];function h(n){const e={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h2,{id:"\u4f7f\u7528-konva-\u5728-html5-canvas-\u4e0a\u8df3\u5f62\u72b6\u63a2\u6208",children:"\u4f7f\u7528 Konva \u5728 HTML5 Canvas \u4e0a\u8df3\u5f62\u72b6\u63a2\u6208"}),"\n",(0,o.jsx)(e.p,{children:"\u6b64\u6f14\u793a\u5c55\u793a\u4e86\u5982\u4f55\u521b\u5efa\u89e6\u53d1\u65f6\u56f4\u7ed5\u753b\u5e03\u8df3\u821e\u7684\u52a8\u753b\u5f62\u72b6\u3002\u5b83\u6f14\u793a\u4e86\uff1a"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"\u521b\u5efa\u5177\u6709\u4e0d\u540c\u5c5e\u6027\u7684\u968f\u673a\u5f62\u72b6"}),"\n",(0,o.jsx)(e.li,{children:"\u4f7f\u7528 Konva \u7684\u8865\u95f4\u7cfb\u7edf\u5b9e\u73b0\u5e73\u6ed1\u52a8\u753b"}),"\n",(0,o.jsx)(e.li,{children:"\u5904\u7406\u7528\u6237\u4ea4\u4e92\uff08\u62d6\u653e\u3001\u6309\u94ae\u70b9\u51fb\uff09"}),"\n",(0,o.jsx)(e.li,{children:"\u540c\u65f6\u7ba1\u7406\u591a\u4e2a\u52a8\u753b"}),"\n"]}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"\u4f7f\u7528\u8bf4\u660e\uff1a"})," \u62d6\u653e\u5f62\u72b6\u4ee5\u8c03\u6574\u4f4d\u7f6e\uff0c\u7136\u540e\u70b9\u51fb \u201cTango!\u201d \u6309\u94ae\u8ba9\u5b83\u4eec\u5728\u753b\u5e03\u4e0a\u8df3\u821e\u3002\u6bcf\u4e2a\u5f62\u72b6\u5c06\u79fb\u52a8\u5230\u968f\u673a\u4f4d\u7f6e\uff0c\u65cb\u8f6c\uff0c\u6539\u53d8\u5927\u5c0f\u548c\u989c\u8272\u3002\u5237\u65b0\u9875\u9762\u4ee5\u751f\u6210\u65b0\u7684\u968f\u673a\u5f62\u72b6\u3002"]}),"\n","\n",(0,o.jsxs)(s.A,{children:[(0,o.jsx)(l.A,{value:"Vanilla",default:!0,children:(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-js",metastring:"live vanilla",live:!0,children:"import Konva from 'konva';\n\n// \u521b\u5efa\u6309\u94ae\nconst button = document.createElement('button');\nbutton.textContent = 'Tango!';\nbutton.style.position = 'absolute';\nbutton.style.top = '10px';\nbutton.style.left = '10px';\nbutton.style.padding = '10px';\ndocument.body.appendChild(button);\n\nconst stage = new Konva.Stage({\n  container: 'container',\n  width: window.innerWidth,\n  height: window.innerHeight,\n});\n\nconst layer = new Konva.Layer();\nstage.add(layer);\n\nconst colors = ['red', 'orange', 'yellow', 'green', 'blue', 'purple'];\n\nfunction getRandomColor() {\n  return colors[Math.floor(Math.random() * colors.length)];\n}\n\nfunction tango(layer) {\n  layer.getChildren().forEach((shape) => {\n    const radius = Math.random() * 100 + 20;\n    \n    new Konva.Tween({\n      node: shape,\n      duration: 1,\n      x: Math.random() * stage.width(),\n      y: Math.random() * stage.height(),\n      rotation: Math.random() * 360,\n      radius: radius,\n      opacity: (radius - 20) / 100,\n      easing: Konva.Easings.EaseInOut,\n      fill: getRandomColor(),\n    }).play();\n  });\n}\n\n// \u521b\u5efa\u521d\u59cb\u5f62\u72b6\nfor (let n = 0; n < 10; n++) {\n  const radius = Math.random() * 100 + 20;\n  const shape = new Konva.RegularPolygon({\n    x: Math.random() * stage.width(),\n    y: Math.random() * stage.height(),\n    sides: Math.ceil(Math.random() * 5 + 3),\n    radius: radius,\n    fill: getRandomColor(),\n    opacity: (radius - 20) / 100,\n    draggable: true,\n  });\n\n  layer.add(shape);\n}\n\nbutton.addEventListener('click', () => tango(layer));\n"})})}),(0,o.jsx)(l.A,{value:"React",children:(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-js",metastring:"live react",live:!0,children:"import React from 'react';\nimport { Stage, Layer, RegularPolygon } from 'react-konva';\n\nconst COLORS = ['red', 'orange', 'yellow', 'green', 'blue', 'purple'];\nconst NUM_SHAPES = 10;\n\nconst getRandomColor = () => COLORS[Math.floor(Math.random() * COLORS.length)];\n\nconst getRandomShapeProps = (width, height) => {\n  const radius = Math.random() * 100 + 20;\n  return {\n    x: Math.random() * width,\n    y: Math.random() * height,\n    sides: Math.ceil(Math.random() * 5 + 3),\n    radius,\n    fill: getRandomColor(),\n    opacity: (radius - 20) / 100,\n  };\n};\n\nconst App = () => {\n  const [shapes, setShapes] = React.useState([]);\n  const stageRef = React.useRef();\n\n  React.useEffect(() => {\n    const initialShapes = Array.from({ length: NUM_SHAPES }, () =>\n      getRandomShapeProps(window.innerWidth, window.innerHeight)\n    );\n    setShapes(initialShapes);\n  }, []);\n\n  const handleDragEnd = (e, index) => {\n    const newShapes = [...shapes];\n    newShapes[index] = {\n      ...newShapes[index],\n      x: e.target.x(),\n      y: e.target.y(),\n    };\n    setShapes(newShapes);\n  };\n\n  const handleTango = () => {\n    const layer = stageRef.current.findOne('Layer');\n    const shapeNodes = layer.find('RegularPolygon');\n\n    shapeNodes.forEach((node, i) => {\n      const radius = Math.random() * 100 + 20;\n      const newProps = {\n        duration: 1,\n        x: Math.random() * window.innerWidth,\n        y: Math.random() * window.innerHeight,\n        rotation: Math.random() * 360,\n        radius: radius,\n        opacity: (radius - 20) / 100,\n        easing: Konva.Easings.EaseInOut,\n        fill: getRandomColor(),\n      };\n\n      node.to(newProps);\n\n      // \u52a8\u753b\u540e\u66f4\u65b0\u72b6\u6001\n      setTimeout(() => {\n        setShapes(prev => {\n          const newShapes = [...prev];\n          newShapes[i] = { ...newShapes[i], ...newProps };\n          return newShapes;\n        });\n      }, 1000);\n    });\n  };\n\n  return (\n    <>\n      <Stage\n        width={window.innerWidth}\n        height={window.innerHeight}\n        ref={stageRef}\n      >\n        <Layer>\n          {shapes.map((shape, i) => (\n            <RegularPolygon\n              key={i}\n              {...shape}\n              draggable\n              onDragEnd={(e) => handleDragEnd(e, i)}\n            />\n          ))}\n        </Layer>\n      </Stage>\n      <button\n        onClick={handleTango}\n        style={{\n          position: 'absolute',\n          top: '10px',\n          left: '10px',\n          padding: '10px',\n        }}\n      >\n        Tango!\n      </button>\n    </>\n  );\n};\n\nexport default App;\n"})})}),(0,o.jsx)(l.A,{value:"Vue",children:(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-js",metastring:"live vue",live:!0,children:"<template>\n  <div>\n    <v-stage\n      :config=\"stageConfig\"\n      ref=\"stageRef\"\n    >\n      <v-layer>\n        <v-regular-polygon\n          v-for=\"(shape, i) in shapes\"\n          :key=\"i\"\n          :config=\"{ ...shape, draggable: true }\"\n          @dragend=\"(e) => handleDragEnd(e, i)\"\n        />\n      </v-layer>\n    </v-stage>\n    <button\n      @click=\"handleTango\"\n      style=\"position: absolute; top: 10px; left: 10px; padding: 10px\"\n    >\n      Tango!\n    </button>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue';\n\nconst COLORS = ['red', 'orange', 'yellow', 'green', 'blue', 'purple'];\nconst NUM_SHAPES = 10;\n\nconst shapes = ref([]);\nconst stageRef = ref(null);\n\nconst stageConfig = {\n  width: window.innerWidth,\n  height: window.innerHeight,\n};\n\nconst getRandomColor = () => COLORS[Math.floor(Math.random() * COLORS.length)];\n\nconst getRandomShapeProps = () => {\n  const radius = Math.random() * 100 + 20;\n  return {\n    x: Math.random() * stageConfig.width,\n    y: Math.random() * stageConfig.height,\n    sides: Math.ceil(Math.random() * 5 + 3),\n    radius,\n    fill: getRandomColor(),\n    opacity: (radius - 20) / 100,\n  };\n};\n\nconst handleDragEnd = (e, index) => {\n  const newShapes = [...shapes.value];\n  newShapes[index] = {\n    ...newShapes[index],\n    x: e.target.x(),\n    y: e.target.y(),\n  };\n  shapes.value = newShapes;\n};\n\nconst handleTango = () => {\n  const stage = stageRef.value.getStage();\n  const layer = stage.findOne('Layer');\n  const shapeNodes = layer.find('RegularPolygon');\n\n  shapeNodes.forEach((node, i) => {\n    const radius = Math.random() * 100 + 20;\n    const newProps = {\n      duration: 1,\n      x: Math.random() * stageConfig.width,\n      y: Math.random() * stageConfig.height,\n      rotation: Math.random() * 360,\n      radius: radius,\n      opacity: (radius - 20) / 100,\n      easing: Konva.Easings.EaseInOut,\n      fill: getRandomColor(),\n    };\n\n    node.to(newProps);\n\n    // \u52a8\u753b\u540e\u66f4\u65b0\u72b6\u6001\n    setTimeout(() => {\n      const newShapes = [...shapes.value];\n      newShapes[i] = { ...newShapes[i], ...newProps };\n      shapes.value = newShapes;\n    }, 1000);\n  });\n};\n\nonMounted(() => {\n  shapes.value = Array.from({ length: NUM_SHAPES }, getRandomShapeProps);\n});\n<\/script>\n"})})})]})]})}function p(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(h,{...n})}):h(n)}},19365:(n,e,a)=>{a.d(e,{A:()=>s});a(96540);var t=a(34164);const o={tabItem:"tabItem_Ymn6"};var r=a(74848);function s(n){let{children:e,hidden:a,className:s}=n;return(0,r.jsx)("div",{role:"tabpanel",className:(0,t.A)(o.tabItem,s),hidden:a,children:e})}},11470:(n,e,a)=>{a.d(e,{A:()=>S});var t=a(96540),o=a(34164),r=a(23104),s=a(56347),l=a(205),i=a(57485),u=a(31682),d=a(70679);function c(n){return t.Children.toArray(n).filter((n=>"\n"!==n)).map((n=>{if(!n||(0,t.isValidElement)(n)&&function(n){const{props:e}=n;return!!e&&"object"==typeof e&&"value"in e}(n))return n;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof n.type?n.type:n.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(n){const{values:e,children:a}=n;return(0,t.useMemo)((()=>{const n=e??function(n){return c(n).map((n=>{let{props:{value:e,label:a,attributes:t,default:o}}=n;return{value:e,label:a,attributes:t,default:o}}))}(a);return function(n){const e=(0,u.XI)(n,((n,e)=>n.value===e.value));if(e.length>0)throw new Error(`Docusaurus error: Duplicate values "${e.map((n=>n.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(n),n}),[e,a])}function p(n){let{value:e,tabValues:a}=n;return a.some((n=>n.value===e))}function g(n){let{queryString:e=!1,groupId:a}=n;const o=(0,s.W6)(),r=function(n){let{queryString:e=!1,groupId:a}=n;if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:e,groupId:a});return[(0,i.aZ)(r),(0,t.useCallback)((n=>{if(!r)return;const e=new URLSearchParams(o.location.search);e.set(r,n),o.replace({...o.location,search:e.toString()})}),[r,o])]}function m(n){const{defaultValue:e,queryString:a=!1,groupId:o}=n,r=h(n),[s,i]=(0,t.useState)((()=>function(n){let{defaultValue:e,tabValues:a}=n;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${a.map((n=>n.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=a.find((n=>n.default))??a[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:e,tabValues:r}))),[u,c]=g({queryString:a,groupId:o}),[m,f]=function(n){let{groupId:e}=n;const a=function(n){return n?`docusaurus.tab.${n}`:null}(e),[o,r]=(0,d.Dv)(a);return[o,(0,t.useCallback)((n=>{a&&r.set(n)}),[a,r])]}({groupId:o}),v=(()=>{const n=u??m;return p({value:n,tabValues:r})?n:null})();(0,l.A)((()=>{v&&i(v)}),[v]);return{selectedValue:s,selectValue:(0,t.useCallback)((n=>{if(!p({value:n,tabValues:r}))throw new Error(`Can't select invalid tab value=${n}`);i(n),c(n),f(n)}),[c,f,r]),tabValues:r}}var f=a(92303);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=a(74848);function w(n){let{className:e,block:a,selectedValue:t,selectValue:s,tabValues:l}=n;const i=[],{blockElementScrollPositionUntilNextRender:u}=(0,r.a_)(),d=n=>{const e=n.currentTarget,a=i.indexOf(e),o=l[a].value;o!==t&&(u(e),s(o))},c=n=>{let e=null;switch(n.key){case"Enter":d(n);break;case"ArrowRight":{const a=i.indexOf(n.currentTarget)+1;e=i[a]??i[0];break}case"ArrowLeft":{const a=i.indexOf(n.currentTarget)-1;e=i[a]??i[i.length-1];break}}e?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.A)("tabs",{"tabs--block":a},e),children:l.map((n=>{let{value:e,label:a,attributes:r}=n;return(0,b.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:n=>i.push(n),onKeyDown:c,onClick:d,...r,className:(0,o.A)("tabs__item",v.tabItem,r?.className,{"tabs__item--active":t===e}),children:a??e},e)}))})}function y(n){let{lazy:e,children:a,selectedValue:r}=n;const s=(Array.isArray(a)?a:[a]).filter(Boolean);if(e){const n=s.find((n=>n.props.value===r));return n?(0,t.cloneElement)(n,{className:(0,o.A)("margin-top--md",n.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:s.map(((n,e)=>(0,t.cloneElement)(n,{key:e,hidden:n.props.value!==r})))})}function x(n){const e=m(n);return(0,b.jsxs)("div",{className:(0,o.A)("tabs-container",v.tabList),children:[(0,b.jsx)(w,{...e,...n}),(0,b.jsx)(y,{...e,...n})]})}function S(n){const e=(0,f.A)();return(0,b.jsx)(x,{...n,children:c(n.children)},String(e))}},28453:(n,e,a)=>{a.d(e,{R:()=>s,x:()=>l});var t=a(96540);const o={},r=t.createContext(o);function s(n){const e=t.useContext(r);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:s(n.components),t.createElement(r.Provider,{value:e},n.children)}}}]);