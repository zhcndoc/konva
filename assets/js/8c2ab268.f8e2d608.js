"use strict";(self.webpackChunkkonva_site_2=self.webpackChunkkonva_site_2||[]).push([[5573],{98343:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"docs/sandbox/Rich_Text","title":"\u5982\u4f55\u5728\u753b\u5e03\u4e0a\u4f7f\u7528 Konva \u663e\u793a\u4e30\u5bcc\u7684 HTML","description":"\u5982\u4f55\u663e\u793a\u590d\u6742\u6837\u5f0f\uff08\u5982\u7c97\u4f53\uff09\u5e76\u542f\u7528\u5bcc\u6587\u672c\u7f16\u8f91\u529f\u80fd\uff1f","source":"@site/content/docs/sandbox/Rich_Text.mdx","sourceDirName":"docs/sandbox","slug":"/docs/sandbox/Rich_Text.html","permalink":"/docs/sandbox/Rich_Text.html","draft":false,"unlisted":false,"editUrl":"https://github.com/zhcndoc/konva/tree/main/content/docs/sandbox/Rich_Text.mdx","tags":[],"version":"current","frontMatter":{"title":"\u5982\u4f55\u5728\u753b\u5e03\u4e0a\u4f7f\u7528 Konva \u663e\u793a\u4e30\u5bcc\u7684 HTML","sidebar_label":"\u5bcc\u6587\u672c","hide_table_of_contents":true,"slug":"Rich_Text.html"},"sidebar":"tutorialsSidebar","previous":{"title":"\u54cd\u5e94\u5f0f\u753b\u5e03","permalink":"/docs/sandbox/Responsive_Canvas.html"},"next":{"title":"\u753b\u5e03\u4e0a\u7684 SVG","permalink":"/docs/sandbox/SVG_On_Canvas.html"}}');var s=t(74848),a=t(28453);const i={title:"\u5982\u4f55\u5728\u753b\u5e03\u4e0a\u4f7f\u7528 Konva \u663e\u793a\u4e30\u5bcc\u7684 HTML",sidebar_label:"\u5bcc\u6587\u672c",hide_table_of_contents:!0,slug:"Rich_Text.html"},r=void 0,c={},l=[{value:"\u5982\u4f55\u663e\u793a\u590d\u6742\u6837\u5f0f\uff08\u5982\u7c97\u4f53\uff09\u5e76\u542f\u7528\u5bcc\u6587\u672c\u7f16\u8f91\u529f\u80fd\uff1f",id:"\u5982\u4f55\u663e\u793a\u590d\u6742\u6837\u5f0f\u5982\u7c97\u4f53\u5e76\u542f\u7528\u5bcc\u6587\u672c\u7f16\u8f91\u529f\u80fd",level:2}];function d(n){const e={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,a.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h2,{id:"\u5982\u4f55\u663e\u793a\u590d\u6742\u6837\u5f0f\u5982\u7c97\u4f53\u5e76\u542f\u7528\u5bcc\u6587\u672c\u7f16\u8f91\u529f\u80fd",children:"\u5982\u4f55\u663e\u793a\u590d\u6742\u6837\u5f0f\uff08\u5982\u7c97\u4f53\uff09\u5e76\u542f\u7528\u5bcc\u6587\u672c\u7f16\u8f91\u529f\u80fd\uff1f"}),"\n",(0,s.jsxs)(e.p,{children:["Canvas \u7684\u6587\u672c API \u975e\u5e38\u6709\u9650\u3002",(0,s.jsx)(e.a,{href:"/docs/shapes/Text.html",children:"Konva.Text"})," \u5141\u8bb8\u60a8\u6dfb\u52a0\u591a\u79cd\u4e0d\u540c\u7684\u6837\u5f0f\uff0c\u652f\u6301\u591a\u884c\u6587\u672c\u7b49\u3002\u4f46\u76ee\u524d\u5b83\u5b58\u5728\u4e00\u4e9b\u9650\u5236\u3002\u60a8\u65e0\u6cd5\u4e3a ",(0,s.jsx)(e.code,{children:"Konva.Text"})," \u7684\u4e0d\u540c\u90e8\u5206\u4f7f\u7528\u4e0d\u540c\u7684\u6837\u5f0f\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u60a8\u5fc5\u987b\u4f7f\u7528\u591a\u4e2a ",(0,s.jsx)(e.code,{children:"Konva.Text"})," \u5b9e\u4f8b\u3002"]}),"\n",(0,s.jsx)(e.p,{children:"\u5982\u679c\u60a8\u60f3\u5728\u753b\u5e03\u4e0a\u663e\u793a\u590d\u6742\u6837\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e00\u79cd hacky \u7684\u53d8\u901a\u65b9\u6cd5\u3002\u8fd9\u4e2a\u60f3\u6cd5\u5f88\u7b80\u5355\uff1a"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"\u521b\u5efa\u4e00\u4e2a DOM \u5143\u7d20\u5e76\u5728\u5176\u4e2d\u653e\u5165\u6837\u5f0f\u5316\u6587\u672c"}),"\n",(0,s.jsxs)(e.li,{children:["\u4f7f\u7528 ",(0,s.jsx)(e.a,{href:"https://html2canvas.hertzen.com/",children:"html2canvas"})," \u5c06 DOM \u5143\u7d20\u8f6c\u6362\u4e3a\u56fe\u50cf\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:["\u4f7f\u7528\u8be5\u56fe\u50cf\u4f5c\u4e3a ",(0,s.jsx)(e.code,{children:"Konva.Image"}),"\u3002"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u8bf4\u660e\uff1a\u5c1d\u8bd5\u5728\u4e0a\u9762\u7684\u7f16\u8f91\u5668\u4e2d\u8f93\u5165\u548c\u683c\u5f0f\u5316\u6587\u672c\u3002\u683c\u5f0f\u5316\u540e\u7684\u6587\u672c\u5c06\u4f5c\u4e3a\u56fe\u50cf\u5448\u73b0\u5728\u4e0b\u9762\u7684\u753b\u5e03\u4e0a\u3002\u60a8\u53ef\u4ee5\u62d6\u52a8\u6e32\u67d3\u7684\u6587\u672c\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",metastring:"live vanilla",live:!0,children:"import Konva from 'konva';\n\n// \u9996\u5148\u6211\u4eec\u9700\u8981\u52a0\u8f7d Quill \u548c html2canvas\nconst loadScript = (src) => {\n  return new Promise((resolve, reject) => {\n    const script = document.createElement('script');\n    script.src = src;\n    script.onload = resolve;\n    script.onerror = reject;\n    document.head.appendChild(script);\n  });\n};\n\nconst loadCSS = (href) => {\n  const link = document.createElement('link');\n  link.rel = 'stylesheet';\n  link.href = href;\n  document.head.appendChild(link);\n};\n\n// \u521b\u5efa\u7f16\u8f91\u5668\u5bb9\u5668\nconst editorContainer = document.createElement('div');\neditorContainer.id = 'editor-container';\neditorContainer.style.height = '80px';\neditorContainer.innerHTML = `\n  \u90a3\u662f <u>\u4e00\u4e9b</u> <span style=\"color: red\"> \u6837\u5f0f\u5316\u6587\u672c</span> \u5728\n  <strong>\u753b\u5e03</strong>\u4e0a\uff01\n  <h2>\u4f60\u89c9\u5f97\u600e\u4e48\u6837\uff1f</h2>\n`;\ndocument.body.appendChild(editorContainer);\n\n// \u52a0\u8f7d\u4f9d\u8d56\nPromise.all([\n  loadScript('https://cdn.quilljs.com/1.3.6/quill.js'),\n  loadScript('https://html2canvas.hertzen.com/dist/html2canvas.min.js'),\n]).then(() => {\n  loadCSS('https://cdn.quilljs.com/1.3.6/quill.snow.css');\n\n  const quill = new Quill('#editor-container', {\n    modules: {\n      toolbar: [\n        [{ header: [1, 2, false] }],\n        ['bold', 'italic', 'underline'],\n        ['image', 'code-block'],\n      ],\n    },\n    placeholder: '\u64b0\u5199\u4e00\u7bc7\u53f2\u8bd7...',\n    theme: 'snow',\n  });\n\n  const stage = new Konva.Stage({\n    container: 'container',\n    width: window.innerWidth,\n    height: 200,\n  });\n\n  const layer = new Konva.Layer();\n  stage.add(layer);\n\n  const shape = new Konva.Image({\n    x: 10,\n    y: 10,\n    draggable: true,\n    stroke: 'red',\n    scaleX: 1 / window.devicePixelRatio,\n    scaleY: 1 / window.devicePixelRatio,\n  });\n  layer.add(shape);\n\n  function renderText() {\n    // \u5c06 DOM \u8f6c\u6362\u4e3a\u56fe\u50cf\n    html2canvas(document.querySelector('.ql-editor'), {\n      backgroundColor: 'rgba(0,0,0,0)',\n    }).then((canvas) => {\n      // \u5728 Konva.Image \u4e2d\u663e\u793a\u5b83\n      shape.image(canvas);\n    });\n  }\n\n  // \u6279\u91cf\u66f4\u65b0\uff0c\u4ee5\u4fbf\u6211\u4eec\u4e0d\u4f1a\u9891\u7e41\u6e32\u67d3\u6587\u672c\n  let timeout = null;\n  function requestTextUpdate() {\n    if (timeout) {\n      return;\n    }\n    timeout = setTimeout(function () {\n      timeout = null;\n      renderText();\n    }, 500);\n  }\n\n  // \u5728\u6240\u6709\u66f4\u6539\u4e0a\u6e32\u67d3\u6587\u672c\n  quill.on('text-change', requestTextUpdate);\n  // \u8fdb\u884c\u521d\u59cb\u6e32\u67d3\n  renderText();\n});\n"})})]})}function h(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>i,x:()=>r});var o=t(96540);const s={},a=o.createContext(s);function i(n){const e=o.useContext(a);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:i(n.components),o.createElement(a.Provider,{value:e},n.children)}}}]);